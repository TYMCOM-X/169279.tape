C
C************************
C
C       PAP15
C
C************************
C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C       SUBROUTINE TO CHANGE THE CONTROL GROUP
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
        SUBROUTINE CHHN1
C
        INTEGER HN,NHN,TNUM,NUMBER,Z,BAS(5),IERT,IERC,NETOP
        DIMENSION NETOP(9)
        DATA (NETOP(I),I=1,9)/'NSSC','NETCN','VANCF','TCSUP','NETOP',
     1  'NSSC','NETCN','VANCF','TCSUP'/
C
90      ENCODE(15,95,BAS)
95      FORMAT('BASE1',10X)
        Z=1
100     TYPE 105
105     FORMAT(1X,'TICKET NUMBER : ',$)
        ACCEPT 110,TNUM
110     FORMAT(I8)
        IF (TNUM.EQ.0) RETURN
114     CALL DBOPEN(BAS)
        CALL DBFIND(1,1,TNUM)
        CALL DBNREC(NUMBER)
        IF (NUMBER.EQ.0) GOTO 200
        CALL DBGREC($300,NUMBER)
        CALL DBVAL('HN',HN)
116     TYPE 115,TNUM,NETOP(HN)
115     FORMAT(/1X,'THE CURRENT CONTROL GROUP FOR TICKET NUMBER ',I8,
     1  ' IS... ',/,/5X,A5,/,/10X,'1 = NSSC',/10X,'2 = NETCON',
     2  /10X,'3 = VANCF',/10X,'4 = TCSUP',/1X,'ENTER THE NEW VALUE ',
     3  'OR A C.R. FOR NO CHANGE : ',$)
        ACCEPT 120,NHN
        IF (NHN.GT.4) GOTO 116
120     FORMAT(I1)
        IF (NHN.EQ.0) GOTO 300
        IF (HN.GT.5) NHN=NHN+5
125     CALL DBERR($130,IERT,IERC,0)
        GOTO 135
130     IF (IERT.NE.7) GOTO 295
        TYPE 132
132     FORMAT(1X,'DATA BASE BUSY... WAITING 10 SECS.')
        CALL WAIT(8.0)
135     CALL DBOPEN(BAS)
        CALL DBUPD(-1)
        CALL DBFIND(1,1,TNUM)
        CALL DBCHNG('HN',NHN)
        CALL DBCLOSE
        TYPE 140
140     FORMAT(3X'CHANGE IS COMPLETE',/)
        RETURN
200     IF (Z.EQ.2) GOTO 215
        Z=2
        ENCODE(15,205,BAS)
205     FORMAT('BASE4',10X)
        GOTO 114
215     TYPE 220,TNUM
220     FORMAT(1X,'TICKET NUMBER ',I8,' CAN NOT BE FOUND. PLEASE TRY',
     1  ' AGAIN.')
        GOTO 90
295     TYPE 296,IERT,IERC
296     FORMAT(/3X,'ERROR TYPE = ',I5,4X,'ERROR CODE = ',I5,
     1  /,/2X,'CHANGE IS NOT COMPLETE.')
        RETURN
300     TYPE 305
305     FORMAT(1X,'NO CHANGE WAS MADE.')
        CALL DBCLOSE
        RETURN
        END
C
C
C************************
C
C       PAP16
C
C************************
C
C
C       SUBROUTINE TO TAKE NORMAL DATE AND CHANGE TO 1022
C
        SUBROUTINE CGDAT(DAT)
C
        INTEGER DAT,SM,SD,SY
C
        TYPE 100
100     FORMAT(1X,'ENTER DATE MM/DD/YY : ',$)
        ACCEPT 105,SM,SD,SY
105     FORMAT(I2,1X,I2,1X,I4)
        IF (SM.EQ.0) GOTO 110
        CALL CDAT(SY)
        CALL DBDATN(DAT,SM,SD,SY)
        RETURN
110     DAT=0
        RETURN
        END
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C       SUBROUTINE TO CHANGE THE SDAT NUMBER
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
        SUBROUTINE CHSDT1
C
        INTEGER SDAT,NSDAT,TNUM,NUMBER,Z,BAS(5),IERT,IERC,DAT,ELM
C
90      ENCODE(15,95,BAS)
95      FORMAT('BASE1',10X)
        Z=1
        ELM=0
100     TYPE 105
105     FORMAT(1X,'TICKET NUMBER : ',$)
        ACCEPT 110,TNUM
110     FORMAT(I8)
        IF (TNUM.EQ.0) RETURN
114     CALL DBOPEN(BAS)
        CALL DBFIND(1,1,TNUM)
        CALL DBNREC(NUMBER)
        IF (NUMBER.EQ.0) GOTO 200
        CALL DBGREC($300,NUMBER)
        CALL DBVAL('SDAT',SDAT)
        CALL DBNDAT(SDAT,SM,SD,SY)
        TYPE 115,TNUM,SM,SD,SY
115     FORMAT(/1X,'THE CURRENT DATE DOWN FOR TICKET NUMBER ',I8,
     1  ' IS... ',/,/5X,I2,1H-,I2,1H-,I4,/,/1X,'ENTER THE NEW VALUE ',
     2  'OR A C.R. FOR NO CHANGE : ')
        CALL CGDAT(DAT)
120     FORMAT(I6)
        IF (DAT.EQ.0) GOTO 300
125     CALL DBERR($130,IERT,IERC,0)
        GOTO 135
130     IF (IERT.NE.7) GOTO 295
        TYPE 132
132     FORMAT(1X,'DATA BASE BUSY... WAITING 10 SECS.')
        CALL WAIT(8.0)
135     CALL DBOPEN(BAS)
        CALL DBUPD(-1)
        CALL DBFIND(1,1,TNUM)
        CALL DBCHNG('SDAT',DAT,'ELM',ELM)
        CALL DBCLOSE
        TYPE 140
140     FORMAT(3X'CHANGE IS COMPLETE',/)
        RETURN
200     IF (Z.EQ.2) GOTO 215
        Z=2
        ENCODE(15,205,BAS)
205     FORMAT('BASE4',10X)
        GOTO 114
215     TYPE 220,TNUM
220     FORMAT(1X,'TICKET NUMBER ',I8,' CAN NOT BE FOUND. PLEASE TRY',
     1  ' AGAIN.')
        GOTO 90
295     TYPE 296,IERT,IERC
296     FORMAT(/3X,'ERROR TYPE = ',I5,4X,'ERROR CODE = ',I5,
     1  /,/2X,'CHANGE IS NOT COMPLETE.')
        RETURN
300     TYPE 305
305     FORMAT(1X,'NO CHANGE WAS MADE.')
        CALL DBCLOSE
        RETURN
        END
C
C
C************************
C
C       PAP17
C
C************************
C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C       SUBROUTINE TO CHANGE THE DUP NUMBER
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
        SUBROUTINE CHDUP1
C
        INTEGER DUP,DAT,TNUM,NUMBER,Z,BAS(5),IERT,IERC,DAT,ELM
C
90      ENCODE(15,95,BAS)
95      FORMAT('BASE1',10X)
        Z=1
        ELM=0
100     TYPE 105
105     FORMAT(1X,'TICKET NUMBER : ',$)
        ACCEPT 110,TNUM
110     FORMAT(I8)
        IF (TNUM.EQ.0) RETURN
114     CALL DBOPEN(BAS)
        CALL DBFIND(1,1,TNUM)
        CALL DBNREC(NUMBER)
        IF (NUMBER.EQ.0) GOTO 200
        CALL DBGREC($300,NUMBER)
        CALL DBVAL('DUP',DUP)
        CALL DBNDAT(DUP,SM,SD,SY)
        TYPE 115,TNUM,SM,SD,SY
115     FORMAT(/1X,'THE CURRENT DATE UP FOR TICKET NUMBER ',I8,
     1  ' IS... ',/,/5X,I2,1H-,I2,1H-,I4,/,/1X,'ENTER THE NEW VALUE ',
     2  'OR A C.R. FOR NO CHANGE : ')
        CALL CGDAT(DAT)
120     FORMAT(I6)
        IF (DAT.EQ.0) GOTO 300
125     CALL DBERR($130,IERT,IERC,0)
        GOTO 135
130     IF (IERT.NE.7) GOTO 295
        TYPE 132
132     FORMAT(1X,'DATA BASE BUSY... WAITING 10 SECS.')
        CALL WAIT(8.0)
135     CALL DBOPEN(BAS)
        CALL DBUPD(-1)
        CALL DBFIND(1,1,TNUM)
        CALL DBCHNG('DUP',DAT,'ELM',ELM)
        CALL DBCLOSE
        TYPE 140
140     FORMAT(3X'CHANGE IS COMPLETE',/)
        RETURN
200     IF (Z.EQ.2) GOTO 215
        Z=2
        ENCODE(15,205,BAS)
205     FORMAT('BASE4',10X)
        GOTO 114
215     TYPE 220,TNUM
220     FORMAT(1X,'TICKET NUMBER ',I8,' CAN NOT BE FOUND. PLEASE TRY',
     1  ' AGAIN.')
        GOTO 90
295     TYPE 296,IERT,IERC
296     FORMAT(/3X,'ERROR TYPE = ',I5,4X,'ERROR CODE = ',I5,
     1  /,/2X,'CHANGE IS NOT COMPLETE.')
        RETURN
300     TYPE 305
305     FORMAT(1X,'NO CHANGE WAS MADE.')
        CALL DBCLOSE
        RETURN
        END
C
C
C************************
C
C       PAP18
C
C************************
C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C       SUBROUTINE TO GET THE TIME INPUT
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
        SUBROUTINE INPTIM(NTIM)
C
        INTEGER A1,A2,A3,A4,A5,NTIM,TUP
C
100     TYPE 105
105     FORMAT(1X'ENTER THE TIME HH:MM  ? ',$)
        ACCEPT 110,NTIM
110     FORMAT(A5)
        IF (NTIM.EQ.'     ') RETURN
        DECODE(5,115,NTIM)A1,A2,A3,A4,A5
115     FORMAT(A1,A1,A1,A1,A1)
        IF (A3.NE.':') GOTO 100
        RETURN
        END
C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C       SUBROUTINE TO CHANGE THE TIME NUMBER
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
        SUBROUTINE CHTDWN
C
        INTEGER TIME,NTIME,TNUM,NUMBER,Z,BAS(5),IERT,IERC,DAT,ELM,NTIM
C
90      ENCODE(15,95,BAS)
95      FORMAT('BASE1',10X)
        Z=1
        ELM=0
100     TYPE 105
105     FORMAT(1X,'TICKET NUMBER : ',$)
        ACCEPT 110,TNUM
110     FORMAT(I8)
        IF (TNUM.EQ.0) RETURN
114     CALL DBOPEN(BAS)
        CALL DBFIND(1,1,TNUM)
        CALL DBNREC(NUMBER)
        IF (NUMBER.EQ.0) GOTO 200
        CALL DBGREC($300,NUMBER)
        CALL DBVAL('TIME',TIME)
        TYPE 115,TNUM,TIME
115     FORMAT(/1X,'THE CURRENT TIME DOWN FOR TICKET NUMBER ',I8,
     1  ' IS... ',/,/5X,A5,/,/1X,'ENTER THE NEW VALUE ',
     2  'OR A C.R. FOR NO CHANGE : ')
        CALL INPTIM(NTIM)
120     FORMAT(I6)
        IF (NTIM.EQ.0) GOTO 300
125     CALL DBERR($130,IERT,IERC,0)
        GOTO 135
130     IF (IERT.NE.7) GOTO 295
        TYPE 132
132     FORMAT(1X,'DATA BASE BUSY... WAITING 10 SECS.')
        CALL WAIT(8.0)
135     CALL DBOPEN(BAS)
        CALL DBUPD(-1)
        CALL DBFIND(1,1,TNUM)
        CALL DBCHNG('TIME',NTIM,'ELM',ELM)
        CALL DBCLOSE
        TYPE 140
140     FORMAT(3X'CHANGE IS COMPLETE',/)
        RETURN
200     IF (Z.EQ.2) GOTO 215
        Z=2
        ENCODE(15,205,BAS)
205     FORMAT('BASE4',10X)
        GOTO 114
215     TYPE 220,TNUM
220     FORMAT(1X,'TICKET NUMBER ',I8,' CAN NOT BE FOUND. PLEASE TRY',
     1  ' AGAIN.')
        GOTO 90
295     TYPE 296,IERT,IERC
296     FORMAT(/3X,'ERROR TYPE = ',I5,4X,'ERROR CODE = ',I5,
     1  /,/2X,'CHANGE IS NOT COMPLETE.')
        RETURN
300     TYPE 305
305     FORMAT(1X,'NO CHANGE WAS MADE.')
        CALL DBCLOSE
        RETURN
        END
C
C
C************************
C
C       PAP19
C
C************************
C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C       SUBROUTINE TO CHANGE THE TUP NUMBER
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
        SUBROUTINE CHTUP1
C
        INTEGER TUP,NTUP,TNUM,NUMBER,Z,BAS(5),IERT,IERC,DAT,ELM,NTIM
C
90      ENCODE(15,95,BAS)
95      FORMAT('BASE1',10X)
        Z=1
        ELM=0
100     TYPE 105
105     FORMAT(1X,'TICKET NUMBER : ',$)
        ACCEPT 110,TNUM
110     FORMAT(I8)
        IF (TNUM.EQ.0) RETURN
114     CALL DBOPEN(BAS)
        CALL DBFIND(1,1,TNUM)
        CALL DBNREC(NUMBER)
        IF (NUMBER.EQ.0) GOTO 200
        CALL DBGREC($300,NUMBER)
        CALL DBVAL('TUP',TUP)
        TYPE 115,TNUM,TUP
115     FORMAT(/1X,'THE CURRENT TIME UP FOR TICKET NUMBER ',I8,
     1  ' IS... ',/,/5X,A5,/,/1X,'ENTER THE NEW VALUE ',
     2  'OR A C.R. FOR NO CHANGE : ')
        CALL INPTIM(NTIM)
120     FORMAT(I6)
        IF (NTIM.EQ.0) GOTO 300
125     CALL DBERR($130,IERT,IERC,0)
        GOTO 135
130     IF (IERT.NE.7) GOTO 295
        TYPE 132
132     FORMAT(1X,'DATA BASE BUSY... WAITING 10 SECS.')
        CALL WAIT(8.0)
135     CALL DBOPEN(BAS)
        CALL DBUPD(-1)
        CALL DBFIND(1,1,TNUM)
        CALL DBCHNG('TUP',NTIM,'ELM',ELM)
        CALL DBCLOSE
        TYPE 140
140     FORMAT(3X'CHANGE IS COMPLETE',/)
        RETURN
200     IF (Z.EQ.2) GOTO 215
        Z=2
        ENCODE(15,205,BAS)
205     FORMAT('BASE4',10X)
        GOTO 114
215     TYPE 220,TNUM
220     FORMAT(1X,'TICKET NUMBER ',I8,' CAN NOT BE FOUND. PLEASE TRY',
     1  ' AGAIN.')
        GOTO 90
295     TYPE 296,IERT,IERC
296     FORMAT(/3X,'ERROR TYPE = ',I5,4X,'ERROR CODE = ',I5,
     1  /,/2X,'CHANGE IS NOT COMPLETE.')
        RETURN
300     TYPE 305
305     FORMAT(1X,'NO CHANGE WAS MADE.')
        CALL DBCLOSE
        RETURN
        END
C
C
C************************
C
C       PAP20
C
C************************
C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C       SUBROUTINE TO CHANGE THE ELM NUMBER
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
        SUBROUTINE CHELM
C
        INTEGER ELM,NELM,TNUM,NUMBER,Z,BAS(5),IERT,IERC
C
90      ENCODE(15,95,BAS)
95      FORMAT('BASE1',10X)
        Z=1
100     TYPE 105
105     FORMAT(1X,'TICKET NUMBER : ',$)
        ACCEPT 110,TNUM
110     FORMAT(I8)
        IF (TNUM.EQ.0) RETURN
114     CALL DBOPEN(BAS)
        CALL DBFIND(1,1,TNUM)
        CALL DBNREC(NUMBER)
        IF (NUMBER.EQ.0) GOTO 200
        CALL DBGREC($300,NUMBER)
        CALL DBVAL('ELM',ELM)
        TYPE 115,TNUM,ELM
115     FORMAT(/1X,'THE CURRENT ELM NUMBER FOR TICKET NUMBER ',I8,
     1  ' IS... ',/,/5X,I11,/,/1X,'ENTER THE NEW VALUE OR A C.R. FOR ',
     2  'NO CHANGE : ',$)
        ACCEPT 120,NELM
120     FORMAT(I11)
        IF (NELM.EQ.0) GOTO 300
125     CALL DBERR($130,IERT,IERC,0)
        GOTO 135
130     IF (IERT.NE.7) GOTO 295
        TYPE 132
132     FORMAT(1X,'DATA BASE BUSY... WAITING 10 SECS.')
        CALL WAIT(8.0)
135     CALL DBOPEN(BAS)
        CALL DBUPD(-1)
        CALL DBFIND(1,1,TNUM)
        CALL DBCHNG('ELM',NELM)
        CALL DBCLOSE
        TYPE 140
140     FORMAT(3X'CHANGE IS COMPLETE',/)
        RETURN
200     IF (Z.EQ.2) GOTO 215
        Z=2
        ENCODE(15,205,BAS)
205     FORMAT('BASE4',10X)
        GOTO 114
215     TYPE 220,TNUM
220     FORMAT(1X,'TICKET NUMBER ',I8,' CAN NOT BE FOUND. PLEASE TRY',
     1  ' AGAIN.')
        GOTO 90
295     TYPE 296,IERT,IERC
296     FORMAT(/3X,'ERROR TYPE = ',I5,4X,'ERROR CODE = ',I5,
     1  /,/2X,'CHANGE IS NOT COMPLETE.')
        RETURN
300     TYPE 305
305     FORMAT(1X,'NO CHANGE WAS MADE.')
        CALL DBCLOSE
        RETURN
        END
C
C
C************************
C
C       PAP21
C
C************************
C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C       SUBROUTINE TO DROP A TICKET FROM ALL THE BASES
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
        SUBROUTINE DRP1
C
        INTEGER HOST,NHOST,TNUM,NUMBER,Z,BAS(5),IERT,IERC
C
90      ENCODE(15,95,BAS)
95      FORMAT('BASE1',10X)
        Z=1
100     TYPE 105
105     FORMAT(1X,'ENTER THE TICKET NUMBER TO BE DELETED: ',$)
        ACCEPT 110,TNUM
110     FORMAT(I8)
        IF (TNUM.EQ.0) RETURN
125     CALL DBERR($130,IERT,IERC,0)
        GOTO 135
130     IF (IERT.NE.7) GOTO 295
        TYPE 132
132     FORMAT(1X,'DATA BASE BUSY... WAITING 10 SECS.')
        CALL WAIT(8.0)
135     CALL DBOPEN(BAS)
        CALL DBUPD(-1)
        TYPE 136,TNUM,BAS
136     FORMAT(1X,'CHECK TICKET # ',I8,' IN FILE ',A5)
        CALL DBFIND(1,1,TNUM)
        CALL DBNREC(NUMBER)
        IF ((NUMBER.EQ.0).AND.(Z.EQ.1)) GOTO 400
        IF (NUMBER.EQ.0) GOTO 138
        TYPE 137,NUMBER,BAS
137     FORMAT(1X,'DELETED  ',I3,' RECORD(S) FROM ',3A5,1H.)
        CALL DBDEL
138     CALL DBCLOSE
        Z=Z+1
        IF (Z.EQ.2) ENCODE(15,205,BAS)
        IF (Z.EQ.3) ENCODE(15,206,BAS)
        IF (Z.EQ.4) ENCODE(15,207,BAS)
        IF (Z.EQ.5) RETURN
        GOTO 125
205     FORMAT('BASE2',10X)
206     FORMAT('BASE6',10X)
207     FORMAT('CALBAK',9X)
295     TYPE 296,IERT,IERC
296     FORMAT(/3X,'ERROR TYPE = ',I5,4X,'ERROR CODE = ',I5,
     1  /,/2X,'CHANGE IS NOT COMPLETE.')
        RETURN
400     CALL DBCLOSE
        CALL DEOLD(TNUM)
        RETURN
        END
C
C
C************************
C
C       PAP22
C
C************************
C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C       SUBROUTINE TO DROP A TICKET FROM ALL THE BASES
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
        SUBROUTINE DEOLD(TNUM)
C
        INTEGER HOST,NHOST,TNUM,NUMBER,Z,BAS(5),IERT,IERC
C
90      ENCODE(15,95,BAS)
95      FORMAT('BASE4',10X)
        Z=1
125     CALL DBERR($130,IERT,IERC,0)
        GOTO 135
130     IF (IERT.NE.7) GOTO 295
        TYPE 132
132     FORMAT(1X,'DATA BASE BUSY... WAITING 10 SECS.')
        CALL WAIT(8.0)
135     CALL DBOPEN(BAS)
        CALL DBUPD(-1)
        TYPE 136,TNUM,BAS
136     FORMAT(1X,'LOOKING FOR TICKET # ',I8,' IN FILE ',A5)
        CALL DBFIND(1,1,TNUM)
        CALL DBNREC(NUMBER)
        IF (NUMBER.EQ.0) GOTO 138
        TYPE 137,NUMBER,BAS
137     FORMAT(1X,'DELETED  ',I3,' RECORD(S) FROM ',3A5,1H.)
        CALL DBDEL
138     CALL DBCLOSE
        Z=Z+1
        IF (Z.EQ.2) ENCODE(15,205,BAS)
        IF (Z.EQ.3) ENCODE(15,206,BAS)
        IF (Z.EQ.4) ENCODE(15,207,BAS)
        IF (Z.EQ.5) RETURN
        GOTO 125
205     FORMAT('BASE5',10X)
206     FORMAT('BASE7',10X)
207     FORMAT('OCALBK',9X)
295     TYPE 296,IERT,IERC
296     FORMAT(/3X,'ERROR TYPE = ',I5,4X,'ERROR CODE = ',I5,
     1  /,/2X,'CHANGE IS NOT COMPLETE.')
        RETURN
        END
C
C
C************************
C
C       PAP24.FTF
C
C************************
C
C       SUBROUTINE TO BREAK APART THE LAST TWO A5 FIELDS IF THE
C       DISCRIPTION ARRAY. THE CARACTERS DISC(199)=XXYYY AND 
C       DISC(200)=ADCHH.
C               A = V1 ... HARDWARE LEVEL OF ESCALATION
C               B = V2 ... SOFTWARE LEVEL OF ESCALATION
C               C = V3 ... TELCO    LEVEL OF ESCALATION
C              HH = V4 ... HOURS OF CURRENT DEFERMENT
C              XX = V5 ... SPARE
C             YYY = V6 ... TOTAL HOURS OF TICKET DIFFERMENT (V6 = V6 + V4)
C
        SUBROUTINE BDIS(DISC,V1,V2,V3,V4,V5,V6)
C
        INTEGER DISC(200),V1,V2,V3,V4,V5,V6
C
50      DECODE(5,55,DISC(199))V5,V6
55      FORMAT(I2,I3)
60      DECODE(5,65,DISC(200))V1,V2,V3,V4
65      FORMAT(I1,I1,I1,I2)
        RETURN
        END
C
C
C       SUBROUTINE TO GET THE TICKET NUMBER FROM THE DATA BASE
C       AND HAVE IT BROKEN DOWN BY THE "BDISC" SUBROUTINE.
C       IF THE TICKET NUMBER IS ENTERED AS ZERO THAN PARAMETER
C       "D" WILL ALLOW US TO GO BACK TO THE MAIN PROMPT.
C
        SUBROUTINE GDIS(DISC,V1,V2,V3,V4,V5,V6,TNUM,BAS1)
C
        INTEGER TNUM,DISC(200),V1,V2,V3,V4,V5,V6,BAS1(3),NUM,I,B,C
C
40      I=1
50      TYPE 55
55      FORMAT(1X,'TICKET NUMBER : ',T20,$)
        CALL DBOPEN(BAS1)
58      ACCEPT 60,TNUM
60      FORMAT(I8)
65      IF (TNUM.EQ.0) RETURN
        CALL DBFIND(1,1,TNUM)
        CALL DBNREC(NUM)
        IF (NUM.GT.0) GOTO 70
        IF (I.EQ.3) GOTO 200
        TYPE 68,TNUM
68      FORMAT(/3X,'TICKET NUMBER ',I8,' CAN NOT BE FOUND.',/)
        I=I+1
        TYPE 55
        GOTO 58
70      CALL DBGREC($200,1)
        CALL DBVAL('DISC',DISC)
        CALL BDIS(DISC,V1,V2,V3,V4,V5,V6)
        CALL DBCLOSE
        RETURN
200     TYPE 205
205     FORMAT(/3X,'USE THE "O" COMMAND IF YOU NEED HELP.',/)
        TNUM=0
        CALL DBCLOSE
        RETURN
        END
C
C
C       SUBROUTINE TO PACK THE DISCRIPTION BACK INTO A 200 LONG
C       ARRAY.
C
        SUBROUTINE PDIS(DISC,V1,V2,V3,V4,V5,V6)
C
        INTEGER DISC(200),V1,V2,V3,V4,V5,V6
C
50      ENCODE(5,55,DISC(199))V5,V6
55      FORMAT(I2,I3)
60     DE(5,65,DISC(200))V1,V2,V3,V4
65      FORMAT(I1,I1,I1,I2)
        RETURN
        END
C
C
C       ROUTINE TO OPEN UP BASE1 AND CHANGE THE DISCRIPTION
C
C
        SUBROUTINE CDIS(DISC,BAS1,TNUM)
C
        INTEGER DISC(200),BAS1(3),TNUM,IERT,IERC
C
50      CALL DBERR($70,IERT,IERC,0)
        GOTO 80
70      IF (IERT.NE.7) GOTO 200
        TYPE 75
75      FORMAT(3X,'DATA BASE IS BUSY... WAITING 10 SEC.')
        CALL WAIT(10.0)
80      CALL DBOPEN(BAS1)
        CALL DBUPD(-1)
        CALL DBFIND(1,1,TNUM)
        CALL DBCHNG('DISC',DISC)
        CALL DBCLOSE
200     CALLDBERR($205,IERT,IERC,-1)
205     RETURN
        END
C
C

C***********************************
C
C       PAP31.FTF
C
C***********************************

C
C       SUBROUTINE TO GET DATA FROM PORT
C       IF DATA IS NOT RETURNED IN 10 MINUTES
C       THE USER WILL BE DROPED FROM THE HOST
C
        SUBROUTINE DATCHR(ANS,SRT)
C
        INTEGER ANS,PCE,I,J,SRT,M1(5)
C
C       call onint($187)
50      ans='     '
        PCE=0
100     I=1
180     J=1
181     CALL GETCHR(-1,PCE)
        J=J+1
        IF (PCE.LT.1) goto 270
        IF (PCE.EQ."015) GOTO 349
        IF ((PCE.GE."141).AND.(PCE.LE."172))PCE=PCE-"040
        if ((pce.ge."001).and.(pce.le."037)) goto 182
        CALL PUTC(I,ANS,PCE)
        IF (I.EQ.5) GOTO 200
        I=I+1
        GOTO 181
182     if (pce.eq."033) goto 187
        if (pce.eq."021) goto 186
        if (pce.eq."001) goto 184
        CALL PUTC(1,M1(I),PCE)
        GOTO 181
187     CALL OUTONE(-1,"177,ERR)
        ANS='-1'
        PCE=0
        return
186     type 183
183     format(/3x,'input que cleared... re-enter : ',$)
        i=1
        ANS='     '
        goto 181
184     call outone(-1,"010,err)
        call outone(-1,"040,err)
        call outone(-1,"010,err)
        i=i-1
        call putc(i,ans,"010)
        GOTO 181
270     IF (J.GT.600) GOTO 275
        CALL DELAY(-1)
        GOTO 181
275     IF (SRT.EQ.2) GOTO 180
        TYPE 305
305     FORMAT(1X,'TIME OUT...   NOW LEAVING SYSTEM')
        CALL BYE
200     CALL GETCHR(-1,PCE)
        J=J+1
        IF (PCE.LT.1) GOTO 220
        IF (PCE.EQ."015) GOTO 349
        IF (PCE.EQ."021) GOTO 186
        CALL PUTC(I,M1(I),PCE)
        IF (J.GT.600) GOTO 275
        GOTO 200
220     CALL DELAY(-1)
        GOTO 200
349     IF (I.GT.1) GOTO 350
        CALL PUTC(1,ANS,"045)
352     FORMAT(/)
350     CALL GETCHR(-1,PCE)
        TYPE 352
        RETURN
        END
C
c
c****************************************
c
c       routine to force characters to upper case
c
c****************************************
c
        subroutine upcase(value)
c
        integer value(4),pce,i,j,k
c
        type 75
75      format('+','setting upper case...',$)
100     do 150 i=1,20
        call getc(i,value,pce)
        if ((pce.ge."141).and.(pce.le."172)) pce=pce-"040
        call putc(i,value,pce)
150     continue
        type 155
155     format('+','complete',/)
        return
        end
c
C
C       ROUTINE TO FORCE 5 CHARACTERS TO UPPER CASE
C
        SUBROUTINE HISET(IN)
C
        INTEGER IN,PCE,I,K
C
100     DO 150 I=1,5
        CALL GETC(I,IN,PCE)
        IF ((PCE.GE."141).AND.(PCE.LE."172)) PCE=PCE-"040
        CALL PUTC(I,IN,PCE)
150     CONTINUE
        RETURN
        END
C
  sNGÜ