C
C***********************
C
C       PAP38.FTF
C
C***********************
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C       SUBROUTINE TO CHANGE THE COMMENT FIELD
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
        SUBROUTINE CHCOM(BAS)
C
        INTEGER CKT(4),NCKT(4),TNUM,NUMBER,Z,BAS(3),IERT,IERC
C
90      Z=1
100     TYPE 105
105     FORMAT(1X,'TICKET NUMBER : ',$)
        ACCEPT 110,TNUM
110     FORMAT(I8)
        IF (TNUM.EQ.0) RETURN
114     CALL DBOPEN(BAS)
        CALL DBFIND(1,1,TNUM)
        CALL DBNREC(NUMBER)
        IF (NUMBER.EQ.0) GOTO 200
        CALL DBGREC($300,NUMBER)
        CALL DBVAL('COMMNT',CKT)
        TYPE 115,TNUM,CKT
115     FORMAT(/1X,'THE CURRENT COMMENT FOR TICKET NUMBER ',I8,
     1  ' IS... ',/,/5X,4A5,/,/1X,'ENTER THE NEW VALUE OR A C.R. FOR ',
     2  'NO CHANGE : ',$)
        ACCEPT 120,NCKT
120     FORMAT(4A5)
        IF (NCKT(1).EQ.'     ') GOTO 300
        CALL CHA4A(BAS,25,NCKT,TNUM)
        RETURN
200     IF (Z.EQ.2) GOTO 215
        Z=2
        ENCODE(15,205,BAS)
205     FORMAT('BASE4',10X)
        GOTO 114
215     TYPE 220,TNUM
220     FORMAT(1X,'TICKET NUMBER ',I8,' CAN NOT BE FOUND. TRY AGAIN',
     1  ' PLEASE.')
        GOTO 90
295     TYPE 296,IERT,IERC
296     FORMAT(/3X,'ERROR TYPE = ',I5,4X,'ERROR CODE = ',I5,
     1  /,/2X,'CHANGE IS NOT COMPLETE.')
        RETURN
300     TYPE 305
305     FORMAT(1X,'NO CHANGE WAS MADE.')
        CALL DBCLOSE
        RETURN
        END
C
