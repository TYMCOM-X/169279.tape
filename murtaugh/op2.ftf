C
C***********************
C
C       PAP6.FTF
C
C***********************
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C       SUBROUTINE TO CHANGE THE CIRCUIT NUMBER
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
        SUBROUTINE CHACKT
C
        INTEGER CKT(4),NCKT(4),TNUM,NUMBER,Z,BAS(5),IERT,IERC
C
90      ENCODE(15,95,BAS)
95      FORMAT('BASE1',10X)
        Z=1
100     TYPE 105
105     FORMAT(1X,'TICKET NUMBER : ',$)
        ACCEPT 110,TNUM
110     FORMAT(I8)
        IF (TNUM.EQ.0) RETURN
114     CALL DBOPEN(BAS)
        CALL DBFIND(1,1,TNUM)
        CALL DBNREC(NUMBER)
        IF (NUMBER.EQ.0) GOTO 200
        CALL DBGREC($300,NUMBER)
        CALL DBVAL('CKT',CKT)
        TYPE 115,TNUM,CKT
115     FORMAT(/1X,'THE CURRENT CIRCUIT NUMBER FOR TICKET NUMBER ',I8,
     1  ' IS... ',/,/5X,4A5,/,/1X,'ENTER THE NEW VALUE OR A C.R. FOR ',
     2  'NO CHANGE : ',$)
        ACCEPT 120,NCKT
120     FORMAT(4A5)
        IF (NCKT(1).EQ.'     ') GOTO 300
125     CALL DBERR($130,IERT,IERC,0)
        GOTO 135
130     IF (IERT.NE.7) GOTO 295
        TYPE 132
132     FORMAT(1X,'DATA BASE BUSY... WAITING 10 SECS.')
        CALL WAIT(8.0)
135     CALL DBOPEN(BAS)
        CALL DBUPD(-1)
        CALL DBFIND(1,1,TNUM)
        CALL DBCHNG('CKT',NCKT)
        CALL DBCLOSE
        TYPE 140
140     FORMAT(3X'CHANGE IS COMPLETE',/)
        RETURN
200     IF (Z.EQ.2) GOTO 215
        Z=2
        ENCODE(15,205,BAS)
205     FORMAT('BASE4',10X)
        GOTO 114
215     TYPE 220,TNUM
220     FORMAT(1X,'TICKET NUMBER ',I8,' CAN NOT BE FOUND. TRY AGAIN',
     1  ' PLEASE.')
        GOTO 90
295     TYPE 296,IERT,IERC
296     FORMAT(/3X,'ERROR TYPE = ',I5,4X,'ERROR CODE = ',I5,
     1  /,/2X,'CHANGE IS NOT COMPLETE.')
        RETURN
300     TYPE 305
305     FORMAT(1X,'NO CHANGE WAS MADE.')
        CALL DBCLOSE
        RETURN
        END
C
C
C************************
C
C       PAP7
C
C************************
C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C       SUBROUTINE TO CHANGE THE TROUBLE NUMBER
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
        SUBROUTINE CHATRB
C
        INTEGER TRB(4),NTRB(4),TNUM,NUMBER,Z,BAS(5),IERT,IERC
C
90      ENCODE(15,95,BAS)
95      FORMAT('BASE1',10X)
        Z=1
100     TYPE 105
105     FORMAT(1X,'TICKET NUMBER : ',$)
        ACCEPT 110,TNUM
110     FORMAT(I8)
        IF (TNUM.EQ.0) RETURN
114     CALL DBOPEN(BAS)
        CALL DBFIND(1,1,TNUM)
        CALL DBNREC(NUMBER)
        IF (NUMBER.EQ.0) GOTO 200
        CALL DBGREC($300,NUMBER)
        CALL DBVAL('TRB',TRB)
        TYPE 115,TNUM,TRB
115     FORMAT(/1X,'THE CURRENT TROUBLE NUMBER FOR TICKET NUMBER ',I8,
     1  ' IS... ',/,/5X,4A5,/,/1X,'ENTER THE NEW VALUE OR A C.R. FOR ',
     2  'NO CHANGE : ',$)
        ACCEPT 120,NTRB
120     FORMAT(4A5)
        IF (NTRB(1).EQ.'     ') GOTO 300
125     CALL DBERR($130,IERT,IERC,0)
        GOTO 135
130     IF (IERT.NE.7) GOTO 295
        TYPE 132
132     FORMAT(1X,'DATA BASE BUSY... WAITING 10 SECS.')
        CALL WAIT(8.0)
135     CALL DBOPEN(BAS)
        CALL DBUPD(-1)
        CALL DBFIND(1,1,TNUM)
        CALL DBCHNG('TRB',NTRB)
        CALL DBCLOSE
        TYPE 140
140     FORMAT(3X'CHANGE IS COMPLETE',/)
        RETURN
200     IF (Z.EQ.2) GOTO 215
        Z=2
        ENCODE(15,205,BAS)
205     FORMAT('BASE4',10X)
        GOTO 114
215     TYPE 220,TNUM
220     FORMAT(1X,'TICKET NUMBER ',I8,' CAN NOT BE FOUND. TRY AGAIN',
     1  ' PLEASE.')
        GOTO 90
295     TYPE 296,IERT,IERC
296     FORMAT(/3X,'ERROR TYPE = ',I5,4X,'ERROR CODE = ',I5,
     1  /,/2X,'CHANGE IS NOT COMPLETE.')
        RETURN
300     TYPE 305
305     FORMAT(1X,'NO CHANGE WAS MADE.')
        CALL DBCLOSE
        RETURN
        END
C
C
C************************
C
C       PAP8
C
C************************
C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C       SUBROUTINE TO CHANGE THE SITE CONTACT
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
        SUBROUTINE CHASCN
C
        INTEGER SCN(4),NSCN(4),TNUM,NUMBER,Z,BAS(5),IERT,IERC
C
90      ENCODE(15,95,BAS)
95      FORMAT('BASE1',10X)
        Z=1
100     TYPE 105
105     FORMAT(1X,'TICKET NUMBER : ',$)
        ACCEPT 110,TNUM
110     FORMAT(I8)
        IF (TNUM.EQ.0) RETURN
114     CALL DBOPEN(BAS)
        CALL DBFIND(1,1,TNUM)
        CALL DBNREC(NUMBER)
        IF (NUMBER.EQ.0) GOTO 200
        CALL DBGREC($300,NUMBER)
        CALL DBVAL('SCON',SCN)
        TYPE 115,TNUM,SCN
115     FORMAT(/1X,'THE CURRENT SITE CONTACT FOR TICKET NUMBER ',I8,
     1  ' IS... ',/,/5X,4A5,/,/1X,'ENTER THE NEW VALUE OR A C.R. FOR ',
     2  'NO CHANGE : ',$)
        ACCEPT 120,NSCN
120     FORMAT(4A5)
        IF (NSCN(1).EQ.'     ') GOTO 300
125     CALL DBERR($130,IERT,IERC,0)
        GOTO 135
130     IF (IERT.NE.7) GOTO 295
        TYPE 132
132     FORMAT(1X,'DATA BASE BUSY... WAITING 10 SECS.')
        CALL WAIT(8.0)
135     CALL DBOPEN(BAS)
        CALL DBUPD(-1)
        CALL DBFIND(1,1,TNUM)
        CALL DBCHNG('SCON',NSCN)
        CALL DBCLOSE
        TYPE 140
140     FORMAT(3X'CHANGE IS COMPLETE',/)
        RETURN
200     IF (Z.EQ.2) GOTO 215
        Z=2
        ENCODE(15,205,BAS)
205     FORMAT('BASE4',10X)
        GOTO 114
215     TYPE 220,TNUM
220     FORMAT(1X,'TICKET NUMBER ',I8,' CAN NOT BE FOUND. TRY AGAIN',
     1  ' PLEASE.')
        GOTO 90
295     TYPE 296,IERT,IERC
296     FORMAT(/3X,'ERROR TYPE = ',I5,4X,'ERROR CODE = ',I5,
     1  /,/2X,'CHANGE IS NOT COMPLETE.')
        RETURN
300     TYPE 305
305     FORMAT(1X,'NO CHANGE WAS MADE.')
        CALL DBCLOSE
        RETURN
        END
C
C
C************************
C
C       PAP9
C
C************************
C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C       SUBROUTINE TO CHANGE THE SITE PHONE #
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
        SUBROUTINE CHASTP
C
        INTEGER STP(4),NSTP(4),TNUM,NUMBER,Z,BAS(5),IERT,IERC
C
90      ENCODE(15,95,BAS)
95      FORMAT('BASE1',10X)
        Z=1
100     TYPE 105
105     FORMAT(1X,'TICKET NUMBER : ',$)
        ACCEPT 110,TNUM
110     FORMAT(I8)
        IF (TNUM.EQ.0) RETURN
114     CALL DBOPEN(BAS)
        CALL DBFIND(1,1,TNUM)
        CALL DBNREC(NUMBER)
        IF (NUMBER.EQ.0) GOTO 200
        CALL DBGREC($300,NUMBER)
        CALL DBVAL('SITP',STP)
        TYPE 115,TNUM,STP
115     FORMAT(/1X,'THE CURRENT SITE PHONE # FOR TICKET NUMBER ',I8,
     1  ' IS... ',/,/5X,4A5,/,/1X,'ENTER THE NEW VALUE OR A C.R. FOR ',
     2  'NO CHANGE : ',$)
        ACCEPT 120,NSTP
120     FORMAT(4A5)
        IF (NSTP(1).EQ.'     ') GOTO 300
125     CALL DBERR($130,IERT,IERC,0)
        GOTO 135
130     IF (IERT.NE.7) GOTO 295
        TYPE 132
132     FORMAT(1X,'DATA BASE BUSY... WAITING 10 SECS.')
        CALL WAIT(8.0)
135     CALL DBOPEN(BAS)
        CALL DBUPD(-1)
        CALL DBFIND(1,1,TNUM)
        CALL DBCHNG('SITP',NSTP)
        CALL DBCLOSE
        TYPE 140
140     FORMAT(3X'CHANGE IS COMPLETE',/)
        RETURN
200     IF (Z.EQ.2) GOTO 215
        Z=2
        ENCODE(15,205,BAS)
205     FORMAT('BASE4',10X)
        GOTO 114
215     TYPE 220,TNUM
220     FORMAT(1X,'TICKET NUMBER ',I8,' CAN NOT BE FOUND. TRY AGAIN',
     1  ' PLEASE.')
        GOTO 90
295     TYPE 296,IERT,IERC
296     FORMAT(/3X,'ERROR TYPE = ',I5,4X,'ERROR CODE = ',I5,
     1  /,/2X,'CHANGE IS NOT COMPLETE.')
        RETURN
300     TYPE 305
305     FORMAT(1X,'NO CHANGE WAS MADE.')
        CALL DBCLOSE
        RETURN
        END
C
C
C************************
C
C       PAP10

C
C************************
C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C       SUBROUTINE TO CHANGE THE NODE NUMBER
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
        SUBROUTINE CHN1DE
C
        INTEGER NODE,NNODE,TNUM,NUMBER,Z,BAS(5),IERT,IERC
C
90      ENCODE(15,95,BAS)
95      FORMAT('BASE1',10X)
        Z=1
100     TYPE 105
105     FORMAT(1X,'TICKET NUMBER : ',$)
        ACCEPT 110,TNUM
110     FORMAT(I8)
        IF (TNUM.EQ.0) RETURN
114     CALL DBOPEN(BAS)
        CALL DBFIND(1,1,TNUM)
        CALL DBNREC(NUMBER)
        IF (NUMBER.EQ.0) GOTO 200
        CALL DBGREC($300,NUMBER)
        CALL DBVAL('NODE',NODE)
        TYPE 115,TNUM,NODE
115     FORMAT(/1X,'THE CURRENT NODE NUMBER FOR TICKET NUMBER ',I8,
     1  ' IS... ',/,/5X,O5,/,/1X,'ENTER THE NEW VALUE OR A C.R. FOR ',
     2  'NO CHANGE : ',$)
        ACCEPT 120,NNODE
120     FORMAT(O5)
        IF (NNODE.EQ.0) GOTO 300
125     CALL DBERR($130,IERT,IERC,0)
        GOTO 135
130     IF (IERT.NE.7) GOTO 295
        TYPE 132
132     FORMAT(1X,'DATA BASE BUSY... WAITING 10 SECS.')
        CALL WAIT(8.0)
135     CALL DBOPEN(BAS)
        CALL DBUPD(-1)
        CALL DBFIND(1,1,TNUM)
        CALL DBCHNG('NODE',NNODE)
        CALL DBCLOSE
        TYPE 140
140     FORMAT(3X'CHANGE IS COMPLETE',/)
        RETURN
200     IF (Z.EQ.2) GOTO 215
        Z=2
        ENCODE(15,205,BAS)
205     FORMAT('BASE4',10X)
        GOTO 114
215     TYPE 220,TNUM
220     FORMAT(1X,'TICKET NUMBER ',I8,' CAN NOT BE FOUND. PLEASE TRY',
     1  ' AGAIN.')
        GOTO 90
295     TYPE 296,IERT,IERC
296     FORMAT(/3X,'ERROR TYPE = ',I5,4X,'ERROR CODE = ',I5,
     1  /,/2X,'CHANGE IS NOT COMPLETE.')
        RETURN
300     TYPE 305
305     FORMAT(1X,'NO CHANGE WAS MADE.')
        CALL DBCLOSE
        RETURN
        END
C
C
C************************
C
C       PAP11
C
C************************
C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C       SUBROUTINE TO CHANGE THE HOST NUMBER
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
        SUBROUTINE CHH1ST
C
        INTEGER HOST,NHOST,TNUM,NUMBER,Z,BAS(5),IERT,IERC
C
90      ENCODE(15,95,BAS)
95      FORMAT('BASE1',10X)
        Z=1
100     TYPE 105
105     FORMAT(1X,'TICKET NUMBER : ',$)
        ACCEPT 110,TNUM
110     FORMAT(I8)
        IF (TNUM.EQ.0) RETURN
114     CALL DBOPEN(BAS)
        CALL DBFIND(1,1,TNUM)
        CALL DBNREC(NUMBER)
        IF (NUMBER.EQ.0) GOTO 200
        CALL DBGREC($300,NUMBER)
        CALL DBVAL('HOST',HOST)
        TYPE 115,TNUM,HOST
115     FORMAT(/1X,'THE CURRENT HOST NUMBER FOR TICKET NUMBER ',I8,
     1  ' IS... ',/,/5X,I6,/,/1X,'ENTER THE NEW VALUE OR A C.R. FOR ',
     2  'NO CHANGE : ',$)
        ACCEPT 120,NHOST
120     FORMAT(I6)
        IF (NHOST.EQ.0) GOTO 300
125     CALL DBERR($130,IERT,IERC,0)
        GOTO 135
130     IF (IERT.NE.7) GOTO 295
        TYPE 132
132     FORMAT(1X,'DATA BASE BUSY... WAITING 10 SECS.')
        CALL WAIT(8.0)
135     CALL DBOPEN(BAS)
        CALL DBUPD(-1)
        CALL DBFIND(1,1,TNUM)
        CALL DBCHNG('HOST',NHOST)
        CALL DBCLOSE
        TYPE 140
140     FORMAT(3X'CHANGE IS COMPLETE',/)
        RETURN
200     IF (Z.EQ.2) GOTO 215
        Z=2
        ENCODE(15,205,BAS)
205     FORMAT('BASE4',10X)
        GOTO 114
215     TYPE 220,TNUM
220     FORMAT(1X,'TICKET NUMBER ',I8,' CAN NOT BE FOUND. PLEASE TRY',
     1  ' AGAIN.')
        GOTO 90
295     TYPE 296,IERT,IERC
296     FORMAT(/3X,'ERROR TYPE = ',I5,4X,'ERROR CODE = ',I5,
     1  /,/2X,'CHANGE IS NOT COMPLETE.')
        RETURN
300     TYPE 305
305     FORMAT(1X,'NO CHANGE WAS MADE.')
        CALL DBCLOSE
        RETURN
        END
C
C
C************************
C
C       PAP12
C
C************************
C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C       SUBROUTINE TO CHANGE THE SLOT NUMBER
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
        SUBROUTINE CHS1OT
C
        INTEGER SLOT,NSLOT,TNUM,NUMBER,Z,BAS(5),IERT,IERC
C
90      ENCODE(15,95,BAS)
95      FORMAT('BASE1',10X)
        Z=1
100     TYPE 105
105     FORMAT(1X,'TICKET NUMBER : ',$)
        ACCEPT 110,TNUM
110     FORMAT(I8)
        IF (TNUM.EQ.0) RETURN
114     CALL DBOPEN(BAS)
        CALL DBFIND(1,1,TNUM)
        CALL DBNREC(NUMBER)
        IF (NUMBER.EQ.0) GOTO 200
        CALL DBGREC($300,NUMBER)
        CALL DBVAL('SLOT',SLOT)
        TYPE 115,TNUM,SLOT
115     FORMAT(/1X,'THE CURRENT SLOT NUMBER FOR TICKET NUMBER ',I8,
     1  ' IS... ',/,/5X,A2,/,/1X,'ENTER THE NEW VALUE OR A C.R. FOR ',
     2  'NO CHANGE : ',$)
        ACCEPT 120,NSLOT
120     FORMAT(A2)
        IF (NSLOT.EQ.0) GOTO 300
125     CALL DBERR($130,IERT,IERC,0)
        GOTO 135
130     IF (IERT.NE.7) GOTO 295
        TYPE 132
132     FORMAT(1X,'DATA BASE BUSY... WAITING 10 SECS.')
        CALL WAIT(8.0)
135     CALL DBOPEN(BAS)
        CALL DBUPD(-1)
        CALL DBFIND(1,1,TNUM)
        CALL DBCHNG('SLOT',NSLOT)
        CALL DBCLOSE
        TYPE 140
140     FORMAT(3X'CHANGE IS COMPLETE',/)
        RETURN
200     IF (Z.EQ.2) GOTO 215
        Z=2
        ENCODE(15,205,BAS)
205     FORMAT('BASE4',10X)
        GOTO 114
215     TYPE 220,TNUM
220     FORMAT(1X,'TICKET NUMBER ',I8,' CAN NOT BE FOUND. PLEASE TRY',
     1  ' AGAIN.')
        GOTO 90
295     TYPE 296,IERT,IERC
296     FORMAT(/3X,'ERROR TYPE = ',I5,4X,'ERROR CODE = ',I5,
     1  /,/2X,'CHANGE IS NOT COMPLETE.')
        RETURN
300     TYPE 305
305     FORMAT(1X,'NO CHANGE WAS MADE.')
        CALL DBCLOSE
        RETURN
        END
C
C
C************************
C
C       PAP13
C
C************************
C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C       SUBROUTINE TO CHANGE THE CIRCUIT NUMBER
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
        SUBROUTINE CHRW1(SYS)
C
        INTEGER REPN(4),NREPN(4),TNUM,NUMBER,Z,BAS(5),IERT,IERC
        INTEGER RW(3),RW1(3),RW2(3),SYS
        DATA RW/'               '/
        DATA RW1/'COMPANY NAME   '/
        DATA RW2/'REPORTED BY    '/
C
80      IF (SYS.EQ.2) GOTO 85
        DECODE(15,82,RW1)RW(1),RW(2),RW(3)
        GOTO 90
82      FORMAT(3(A5))
85      DECODE(15,82,RW2)RW(1),RW(2),RW(3)
90      ENCODE(15,95,BAS)
95      FORMAT('BASE1',10X)
        Z=1
100     TYPE 105
105     FORMAT(1X,'TICKET NUMBER : ',$)
        ACCEPT 110,TNUM
110     FORMAT(I8)
        IF (TNUM.EQ.0) RETURN
114     CALL DBOPEN(BAS)
        CALL DBFIND(1,1,TNUM)
        CALL DBNREC(NUMBER)
        IF (NUMBER.EQ.0) GOTO 200
        CALL DBGREC($300,NUMBER)
        CALL DBVAL('RNAM',REPN)
        TYPE 115,RW,TNUM,REPN
115     FORMAT(/1X,'THE CURRENT ',3A5,' FOR TICKET NUMBER ',I8,
     1  ' IS... ',/,/5X,4A5,/,/1X,'ENTER THE NEW VALUE OR A C.R. FOR ',
     2  'NO CHANGE : ',$)
        ACCEPT 120,NREPN
120     FORMAT(4A5)
        IF (NREPN(1).EQ.'     ') GOTO 300
125     CALL DBERR($130,IERT,IERC,0)
        GOTO 135
130     IF (IERT.NE.7) GOTO 295
        TYPE 132
132     FORMAT(1X,'DATA BASE BUSY... WAITING 10 SECS.')
        CALL WAIT(8.0)
135     CALL DBOPEN(BAS)
        CALL DBUPD(-1)
        CALL DBFIND(1,1,TNUM)
        CALL DBCHNG('RNAM',NREPN)
        CALL DBCLOSE
        TYPE 140
140     FORMAT(3X'CHANGE IS COMPLETE',/)
        RETURN
200     IF (Z.EQ.2) GOTO 215
        Z=2
        ENCODE(15,205,BAS)
205     FORMAT('BASE4',10X)
        GOTO 114
215     TYPE 220,TNUM
220     FORMAT(1X,'TICKET NUMBER ',I8,' CAN NOT BE FOUND. TRY AGAIN',
     1  ' PLEASE.')
        GOTO 90
295     TYPE 296,IERT,IERC
296     FORMAT(/3X,'ERROR TYPE = ',I5,4X,'ERROR CODE = ',I5,
     1  /,/2X,'CHANGE IS NOT COMPLETE.')
        RETURN
300     TYPE 305
305     FORMAT(1X,'NO CHANGE WAS MADE.')
        CALL DBCLOSE
        RETURN
        END
C
C
C************************
C
C       PAP14
C
C************************
C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C       SUBROUTINE TO CHANGE THE RFON FIELD IN BASE1 OR BASE4
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
        SUBROUTINE CHRP1(SYS)
C
        INTEGER REPF(4),NREPF(4),TNUM,NUMBER,Z,BAS(5),IERT,IERC
        INTEGER RP(3),RP1(3),RP2(3),SYS
        DATA RP/'               '/
        DATA RP1/'TECH CONSULTANT'/
        DATA RP2/'CALL BACK #    '/
C
80      IF (SYS.EQ.2) GOTO 85
        DECODE(15,82,RP1)RP(1),RP(2),RP(3)
        GOTO 90
82      FORMAT(3(A5))
85      DECODE(15,82,RP2)RP(1),RP(2),RP(3)
90      ENCODE(15,95,BAS)
95      FORMAT('BASE1',10X)
        Z=1
100     TYPE 105
105     FORMAT(1X,'TICKET NUMBER : ',$)
        ACCEPT 110,TNUM
110     FORMAT(I8)
        IF (TNUM.EQ.0) RETURN
114     CALL DBOPEN(BAS)
        CALL DBFIND(1,1,TNUM)
        CALL DBNREC(NUMBER)
        IF (NUMBER.EQ.0) GOTO 200
        CALL DBGREC($300,NUMBER)
        CALL DBVAL('RFON',REPF)
        TYPE 115,RP,TNUM,REPF
115     FORMAT(/1X,'THE CURRENT ',3A5,' FOR TICKET NUMBER ',I8,
     1  ' IS... ',/,/5X,4A5,/,/1X,'ENTER THE NEW VALUE OR A C.R. FOR ',
     2  'NO CHANGE : ',$)
        ACCEPT 120,NREPF
120     FORMAT(4A5)
        IF (NREPF(1).EQ.'     ') GOTO 300
125     CALL DBERR($130,IERT,IERC,0)
        GOTO 135
130     IF (IERT.NE.7) GOTO 295
        TYPE 132
132     FORMAT(1X,'DATA BASE BUSY... WAITING 10 SECS.')
        CALL WAIT(8.0)
135     CALL DBOPEN(BAS)
        CALL DBUPD(-1)
        CALL DBFIND(1,1,TNUM)
        CALL DBCHNG('RFON',NREPF)
        CALL DBCLOSE
        TYPE 140
140     FORMAT(3X'CHANGE IS COMPLETE',/)
        RETURN
200     IF (Z.EQ.2) GOTO 215
        Z=2
        ENCODE(15,205,BAS)
205     FORMAT('BASE4',10X)
        GOTO 114
215     TYPE 220,TNUM
220     FORMAT(1X,'TICKET NUMBER ',I8,' CAN NOT BE FOUND. TRY AGAIN',
     1  ' PLEASE.')
        GOTO 90
295     TYPE 296,IERT,IERC
296     FORMAT(/3X,'ERROR TYPE = ',I5,4X,'ERROR CODE = ',I5,
     1  /,/2X,'CHANGE IS NOT COMPLETE.')
        RETURN
300     TYPE 305
305     FORMAT(1X,'NO CHANGE WAS MADE.')
        CALL DBCLOSE
        RETURN
        END
C
 