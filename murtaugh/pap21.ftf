C
C************************
C
C       PAP21
C
C************************
C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C       SUBROUTINE TO DROP A TICKET FROM ALL THE BASES
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
        SUBROUTINE DRP1(UNAM,INT,VERS)
C
        INTEGER HOST,NHOST,TNUM,NUMBER,Z,BAS(3),IERT,IERC
        INTEGER UNAM(3),ANS,INT,TIM1,SDAT,VERS
C
90      ENCODE(15,95,BAS)
95      FORMAT('(TNT)BASE1',5X)
        Z=1
100     TYPE 105
105     FORMAT(1X,'ENTER THE TICKET NUMBER TO BE DELETED: ',$)
        ACCEPT 110,TNUM
110     FORMAT(I6)
        IF (TNUM.EQ.0) RETURN
        CALL RTIM(TIM1,SDAT)
        CALL DBOPEN('(TNT)BASE3')
        CALL DBADD(1,TNUM,2,SDAT,3,TIM1,4,INT,5,'DELET',8,UNAM)
        CALL DBCLOSE
125     CALL DBERR($130,IERT,IERC,0)
        GOTO 135
130     IF (IERT.NE.7) GOTO 295
        TYPE 132
132     FORMAT(1X,'DATA BASE BUSY... WAITING 10 SECS.')
        CALL WAIT(8.0)
135     CALL DBOPEN(BAS)
        CALL DBUPD(-1)
        TYPE 136,TNUM,BAS(1),BAS(2),BAS(3)
136     FORMAT(1X,'CHECK FOR TICKET # ',I6,' IN FILE ',A5,A5,A5)
        CALL DBFIND(1,1,TNUM)
        CALL DBNREC(NUMBER)
        IF ((NUMBER.EQ.0).AND.(Z.EQ.1)) GOTO 400
        IF (NUMBER.EQ.0) GOTO 138
        TYPE 137,NUMBER,BAS(1),BAS(2),BAS(3)
137     FORMAT(1X,'DELETED  ',I3,' RECORD(S) FROM ',A5,A5,A5)
        CALL DBDEL
138     CALL DBCLOSE
        Z=Z+1
        IF (Z.EQ.2) ENCODE(15,205,BAS)
        IF (Z.EQ.3) ENCODE(15,206,BAS)
        IF (Z.EQ.4) ENCODE(15,207,BAS)
        IF (Z.EQ.5) RETURN
        GOTO 125
205     FORMAT('(TNT)BASE2',5X)
206     FORMAT('(TNT)BASE6',5X)
207     FORMAT('(TNT)CALBAK',4X)
295     TYPE 296,IERT,IERC
296     FORMAT(/3X,'ERROR TYPE = ',I5,4X,'ERROR CODE = ',I5,
     1  /,/2X,'CHANGE IS NOT COMPLETE.')
        RETURN
400     CALL DBCLOSE
        CALL DEOLD(TNUM)
        RETURN
        END
C
