C
C************************
C
C       PAP54.FTF
C
C************************
C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C       SUBROUTINE TO CHANGE THE END HOUR
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
        SUBROUTINE CHAEHR(BAS,BAS10)
C
        INTEGER SLOT,NSLOT,TNUM,NUMBER,Z,BAS(3),IERT,IERC,NET(2)
        INTEGER MIDV(4),NT,BAS10(3)
C
90      Z=1
100     TYPE 105
105     FORMAT(1X,'TICKET NUMBER : ',$)
        ACCEPT 110,TNUM
110     FORMAT(I8)
        IF (TNUM.EQ.0) RETURN
114     CALL DBOPEN(BAS)
        CALL DBFIND(1,1,TNUM)
        CALL DBNREC(NUMBER)
        IF (NUMBER.EQ.0) GOTO 200
        CALL DBGREC($300,NUMBER)
        CALL DBVAL('EHR',SLOT,48,NT,9,NET)
        IF (NT.EQ.1) CALL DBVAL(40,MIDV(1))
        IF (NT.EQ.2) CALL DBVAL(42,MIDV(1))
        IF (NT.EQ.3) CALL DBVAL(43,MIDV)
        TYPE 115,TNUM,SLOT
115     FORMAT(/1X,'THE CURRENT END HOUR(GMT) FOR TICKET NUMBER ',I8,
     1  ' IS... ',/,/5X,A5,/,/1X,'ENTER THE NEW VALUE OR A C.R. FOR ',
     2  'NO CHANGE.')
        CALL INPTIM(NSLOT)
120     FORMAT(A5)
        IF (NSLOT.EQ.0) GOTO 300
        CALL CHA1A(BAS,29,NSLOT,TNUM)
        CALL CHRE1A(BAS10,NT,MIDV,15,NSLOT,NET)
        RETURN
200     IF (Z.EQ.2) GOTO 215
        Z=2
        ENCODE(15,205,BAS)
205     FORMAT('BASE4',10X)
        GOTO 114
215     TYPE 220,TNUM
220     FORMAT(1X,'TICKET NUMBER ',I8,' CAN NOT BE FOUND. PLEASE TRY',
     1  ' AGAIN.')
        GOTO 90
295     TYPE 296,IERT,IERC
296     FORMAT(/3X,'ERROR TYPE = ',I5,4X,'ERROR CODE = ',I5,
     1  /,/2X,'CHANGE IS NOT COMPLETE.')
        RETURN
300     TYPE 305
305     FORMAT(1X,'NO CHANGE WAS MADE.')
        CALL DBCLOSE
        RETURN
        END
C
