  
:
: filename: MXGATE.403
: Upgraded from the 5th patch in PACX03.P01.     Jwang, AUG 1988
:==================================================================
:
:PATCH 005  CREATED BY S/WONG  AT 06 MAR 84
:THE FOLLOWING PATCH FORCED THE GATEWAY MACRO FROM PER LINK
:OPTION INTO GLOBAL OPTION. THIS PATCH IS REQUIRED TO SATISFY THE 
:NEED OF CUSTOMER USING A LARGE NUMBER OF LINKS AND WITH MANY
:GATEWAY OPTIONS PER LINK, THUS EXCEEDING THE TOTAL MAXIMUM
:LIMIT OF 256.
:IF THIS PATCH IS ASSEMBLED, ALL LINKS IN THE SLOT WILL USE THE 
:GATEWAY TABLE BELONGING TO THE FIRST LINK! IT ALSO REDUCES THE
:SYSGEN TIME SIGNIFICANTLY.
:METHOD: BY SETTING INDEX REGISTER TO GWDNIC TABLE 0, ALL
:THE LINKS, HAVING THE SAME DNICS, WILL SHARE THE SAME TABLE
:FOR LDNICS AND LOGIN STRINGS.
:THIS PATCH SHOULD NOT BE INCORPORATED INTO THE SOURCE CODE, BUT
:SHOULD BE IN ALL FUTURE SOURCE PATCH RELEASES SO THAT OTHER
:USER CAN TAKE ADVANTAGE OF THIS UNIQUE FEATURE.

        IF      \MXGATE
PATCH(840306,1835,SWONG,PCR429+4,,6)
        L       R4,GWDNIC,,              :PRT TO DNICS FOR THIS LINK
        IF      XOM
CONPATCH(XOMGA2+4,,6)
        L       R8,GWDNIC,,              :PRT TO DNICS FOR THIS LINK
CONPATCH(XMRPG0+4,,6)
        L       R8,GWDNIC,,              :PRT TO LINK'S RPOA ENTRIES
CONPATCH(XMCGA0+12,,6)
        L       R5,GWDNIC,,              :PRT TO LDNICS TABLE
CONPATCH(XMCG10,,4)
        CLHI    R1,0                     :SET NLINK TO 0
CONPATCH(XMCG10+0C,,6)
        AM      R0,GWDNIC,,              :DECREMENT ITS FIRST LDNICS ADDRESS
CONPATCH(XMCG20,,4)
        CLHI    RL,0                     :SET NLINK TO 0
CONPATCH(XMCG20+0E,,6)
        AM      R0,GWDNIC,,              :SET INDEX TO LINK PRT TO 0
        EI      XOM
ENDPATCH(Allow one common lookup Gateway DNIC table for all links)
        EI      MXGATE        

