 
        NAME:   AUXLIB.MAC
 
        AUTHOR: SOFTWARE PRODUCT SUPPORT
 
        PURPOSE:THESE ROUTINES PROVIDE FOR THE INITIALIZATION
                OF AUXILIARY CIRCUITS,READING FROM THE AUXILIARY CIRCUIT
                AND WRITING TO THE AUXILIARY CIRCUIT.
 
                               SUBROUTINE AUXINI
 
        PURPOSE:THIS ROUTINE INITIALIZE THE AUXILIARY CIRCUIT
                TO THE SPECIFIED SYSTEM AND RETURNS THE PORT NO.
                FOR FUTURE READS AND WRITES.
 
        CALLING SEQUENCE:
 
                CALL AUXINI(ISYS,IPORT,IERR)
 
        WHERE:
 
                ISYS = THE SYSTEM TO BUILD A CIRCUIT TO
                IPORT= THE PORT ADDRESS FOR THE CIRCUIT 
                IERR = THE ERROR CODE FOR A FAILURE
 
        ERROR-CODES
 
                00 = NO ERROR, AUX CIRCUIT BUILT
                01 = UNABLE TO GET JOB PRIVLEDGE WORD
                02 = EXECJ USERS ARE NOT ALLOWED TO BUILD AUX CIRCUITS
                03 = UNABLE TO GET USER USERNAME THRU GETTABS
                04 = ERROR RETURNED BY SUPERVISOR. UNABLE TO BUILD CIRCUIT
                05 = PROCESS ALREADY HAS 2 AUX CIRCUITS AND NO AC LICENSE
                06 = ATTEMPT TO BUILD AUX CIRCUIT TO ANOTHER USER NAME
                07 = NO ROOM IN THE MONITOR FOR ANY MORE AUX CIRCUITS
                08 = THE SUPERVISOR DID NOT RESPOND TO THE ORIGINAL REQUEST
                09 = THE SUPERVISOR DID NOT RESPOND TO THE LOGIN MESSAGE
                10 = THE SUPERVISOR DID NOT SUPPLY A CIRCUIT
                11 = THE SUPERVISOR GAVE AN ERROR RESPONSE TO THE ORIGINAL
                     REQUEST
                12 = UNABLE TO INITIATE THE SOFTWARE INTERRUPT SYSTEM
                13 = UNABLE TO ESTABLISH SOFTWARE INTERRUPT CAUSE FOR A
                     CIRCUIT ZAP(LOGOUT)
                14 = UNABLE TO ESTABLISH SOFTWARE INTERRUPT CAUSE FOR A
                     RECEIPT OF CHARACTER ON AUX CIRCUIT.
                15 = UNABLE TO ENABLE SOFTWARE INTERRUPTS
 
        NOTE:   EXECJ USERS MAY NOT USE THESE ROUTINES.
 
 
                               SUBROUTINE AUXRED
 
        PURPOSE:THIS ROUTINE READS A CHARACTER FROM THE AUXILIARY CIRCUIT
                AND RETURNS IT TO THE CALLING PROGRAM. IF THERE
                IS NO CHARACTER IN THE PORTS BUFFER, THE ROUTINE
                WILL RETURN A VALUE OF ONE AS THE ERROR CODE.
 
        CALLING SEQUENCE:
 
                CALL AUXRED(IPORT,ICHAR,IERR)
 
        WHERE:
 
                IPORT = A VALID PORT NO FOR THIS PROCESS
                ICHAR = THE CHARACTER RECEIVED FROM THE PORT
                IERR  = AN ERROR RETURN
 
        ERROR-CODES
 
                00 = NO ERROR, CHARACTER RETURNED FROM PORT
                01 = NO CHARACTERS IN BUFFER
                02 = PORT NO. SUPPLIED BY USER PROGRAM DOES NOT MATCH PORT
                     NO. FROM LAST CALL TO AUXINI
                03 = UNABLE TO RE-ENABLE SOFTWARE INTERRUPT CHANNEL 2
 
 
                               SUBROUTINE AUXWRT
 
        PURPOSE:THIS ROUTINE WRITES A STRING OF CHARACTERS TO THE SPECIFIED
                AUXILIARY CIRCUIT PORT. THE LAST WORD OF THE CHARACTER
                STRING MUST BE A NULL CHARACTER.
 
        CALLING SEQUENCE:
 
                CALL AUXWRT(IPORT,ISTRING)
 
        WHERE:
 
                IPORT = THE PORT NO. FOR THE CIRCUIT
                ISTRING = THE STRING OF CHARACTERS DELIMITED BY A NULL CHARACTER
 
        RETURN CODES - NONE.
 
        NOTE:   THE STRING MUST INCLUDE ALL OF ITS OWN CARIAGE RETURNS.
 
 
                               SUBROUTINE ONCZAP
 
        PURPOSE:THIS ROUTINE ALLOWS THE USER TO SPECIFY A PROGRAM STATEMENT
                LABEL TO TRANSFER CONTROL TO WHEN THE LOSS OF THE AUXILLIARY
                CIRCUIT IS DETECTED.  IF THE USER DOES NOT SPECIFY A 
                LOCATION IN HIS CODE TO TRANSFER TO, THE DEFAULT
                IS TO ISSUE THE FOLLOWING MESSAGE TO THE TERMINAL:
                        AUXILIARY CIRCUIT HAS BEEN ZAPPED
                AND RETURN TO XEXEC LEVEL.
 
        CALLING SEQUENCE:
 
                CALL ONCZAP($LABL)
 
        WHERE:
 
                $LABEL IS A VALID STATEMENT LABEL IN THE USERS PROGRAM
                  PRECEDED BY A $.
 
        RETURN CODES - NONE.
 
 
                        SUBROUTINE CIRCAP
 
        PURPOSE:THIS ROUTINE WILL TEAR DOWN(I.E. ZAP) AN AUXILIARY CIRCUIT
                IF THE PORT SO DESIGNATED BELONGS TO THE USER.
 
        CALLING SEQUENCE:
 
                CALL CIRZAP(IPORT)
 
        RETURN CODES - NONE
 
 
                                FUNCTION NOAXIN
 
        PURPOSE:THIS IS A FORTRAN FUNCTION TO RETURN TO THE USER THE
                CURRENT NUMBER OF CHARACTERS IN THE INPUT/OUTPUT BUFFER
                AREA OF THE AUXILIARY CIRCUIT.
 
        CALLING SEQUENCE:
 
                IA = NOAXIN(X)
 
        RETURN CODES - NONE.
 
        NOTE:   THIS IS AN INTEGER FUNCTION.
 
 
                                FUNCTION QCHRIN
 
        PURPOSE:THIS ROUTINE TELLS THE USER PROGRAM WHETHER OR NOT THERE
        ARE ANY CHARACTERS WAITING IN THE TERMINAL INPUT BUFFER
        THIS IS A FUNCTION.
 
        CALLING SEQUENCE:
 
                I = QCHRIN(I)
 
        WHERE:
 
                I = 0 IF THERE ARE NO CHARACTERS IN THE TERMINAL BUFFER
                I = 1 IF THERE ARE CHARACTERS IN THE TERMINAL BUFFER
 
        NOTE: THIS IS AN INTEEGER FUNCTION.
 
 
                        SUBROUTINE TIMDEL
 
        PURPOSE:THIS ROUTINE INITIALIZES THE TIME DELAY AFTER EACH LINE IS
                SENT DOWN THE AUXILIARY CIRCUIT. THE DEFAULT TIME DELAY
                IS 4 MILLISECONDS. THE TIME MUST BE GREATER THAN OR EQUAL TO 1.
 
        CALLING SEQUENCE:
 
                CALL TIMDEL(ITMDEL)
 
        WHERE:
 
                ITMDEL = THE TIME TO DELAY AFTER EACH LINE IS SENT DOWN
                         THE AUXILIARY CIRCUIT. IF ITMDEL IS LESS THAN OR
                         EQUAL TO ZERO, THE DEFAULT TIME DELAY IS USED(4 
                         MILLISECONDS)
 
        NOTE:ITMDEL IS THE TIME SPECIFIED IN MILLISECONDS.
             MAXIMUM VALUE IS 2^18 -1 OR 262143 MILLISECONDS.
